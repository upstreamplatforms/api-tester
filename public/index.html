<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="initial-scale=1.0" />
        <link rel="icon" type="image/x-icon" href="/favicon.svg" />
        <title>API Tester</title>
        <!-- Load Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- Use Inter font -->
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap");
            body {
                font-family: "Inter", sans-serif;
            }
            /* Custom scrollbar for dark theme */
            ::-webkit-scrollbar {
                width: 8px;
            }
            ::-webkit-scrollbar-track {
                background: #0f172a; /* slate-950 */
            }
            ::-webkit-scrollbar-thumb {
                background: #1e293b; /* slate-800 */
                border-radius: 4px;
            }
            ::-webkit-scrollbar-thumb:hover {
                background: #0d9488; /* teal-600 */
            }
        </style>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            "primary-accent": "#2dd4bf", // teal-400
                            "dark-bg": "#020617", // slate-950
                            "dark-card": "#111827", // gray-900
                        },
                    },
                },
            };
        </script>
    </head>
    <body class="bg-dark-bg text-gray-100 min-h-screen">
        <!-- Navigation -->
        <nav
            class="sticky top-0 z-50 bg-dark-bg/90 backdrop-blur-sm shadow-xl shadow-dark-bg/50"
        >
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="flex items-center justify-between h-16">
                    <div class="flex-shrink-0">
                        <!--<img
                            class="inline relative top-[-8px]"
                            src="/favicon.svg"
                            width="24px"
                        />-->
                        <span
                            class="text-3xl font-extrabold tracking-tight text-primary-accent"
                        >
                            API Tester
                        </span>
                        <span class="text-xs text-gray-400 ml-2">BETA</span>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a
                                href="#features"
                                class="text-gray-300 hover:text-primary-accent transition duration-150"
                                >Background</a
                            >
                            <a
                                href="#usage"
                                class="text-gray-300 hover:text-primary-accent transition duration-150"
                                >Usage</a
                            >
                            <a
                                href="https://github.com/tyayers/upstream-tdd"
                                class="text-gray-300 hover:text-primary-accent transition duration-150"
                                >GitHub</a
                            >
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <header class="relative overflow-hidden pt-16 pb-24 lg:pt-24 lg:pb-32">
            <div
                class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center"
            >
                <!-- Neon Glow Effect (Optional - purely aesthetic) -->
                <div
                    class="absolute inset-x-0 top-0 h-96 w-96 mx-auto bg-primary-accent/10 blur-[150px] rounded-full"
                ></div>

                <h1
                    class="text-6xl sm:text-7xl lg:text-8xl font-extrabold leading-tight tracking-tight mt-10"
                >
                    <span
                        class="block bg-clip-text text-transparent bg-gradient-to-r from-primary-accent to-purple-400"
                    >
                        Unit Test Your APIs.
                    </span>
                    <span class="text-5xl block text-gray-200 mt-4"
                        >Test Everything.</span
                    >
                </h1>
                <p class="mt-6 text-xl text-gray-400 max-w-3xl mx-auto">
                    API Tester is a free and open source platform to add
                    detailed unit tests to API traffic. Because good testing
                    shouldn't just be for source code.
                </p>

                <div class="mt-10 flex justify-center">
                    <button
                        id="openModalBtn"
                        class="mr-2 px-8 py-4 text-xl font-semibold rounded-xl text-dark-bg bg-primary-accent hover:bg-teal-300 transition duration-300 shadow-xl shadow-primary-accent/30 transform hover:scale-[1.02] active:scale-[0.98]"
                    >
                        Create Test Suite
                    </button>
                    <button
                        onclick="openDashboard()"
                        id="openDashboardButton"
                        class="ml-2 px-8 py-4 text-xl font-semibold rounded-xl text-dark-bg bg-primary-accent hover:bg-teal-300 transition duration-300 shadow-xl shadow-primary-accent/30 transform hover:scale-[1.02] active:scale-[0.98]"
                    >
                        Open Dashboard
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content Sections -->
        <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-20 space-y-24">
            <!-- Features Section -->
            <section id="features" class="grid md:grid-cols-3 gap-8">
                <div class="md:col-span-3 text-center mb-8">
                    <!--<div>
                        <img class="m-auto opacity-[.6] border-radius-[24px]" width="154px" src="/trafficlight.png"></img>
                    </div>-->

                    <h2 class="text-4xl font-bold text-gray-200 mb-2">
                        Background
                    </h2>

                    <p class="text-lg text-gray-400">
                        <a
                            href="https://en.wikipedia.org/wiki/Test-driven_development"
                            >TDD</a
                        >
                        is a practice to improve software quality by monitoring
                        detailed test results in a traffic light format. This
                        makes it easier to track quality, and see regressions
                        quickly. API Tester applies this principle to API calls,
                        where quality issues & regressions can often be detected
                        early, before they reach users.
                    </p>
                </div>

                <!-- Card 1 -->
                <div
                    class="p-6 bg-dark-card rounded-xl border border-gray-800 hover:border-primary-accent/50 transition duration-300 shadow-lg"
                >
                    <div class="text-primary-accent mb-3 text-2xl font-bold">
                        <!-- Icon for Orchestration -->

                        <svg
                            viewBox="0 0 512 512"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink"
                            class="h-8 w-8"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                        >
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g
                                id="SVGRepo_tracerCarrier"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            ></g>
                            <g id="SVGRepo_iconCarrier">
                                <title>new-indicator</title>
                                <g
                                    id="Page-1"
                                    stroke="none"
                                    stroke-width="1"
                                    fill="none"
                                    fill-rule="evenodd"
                                >
                                    <g
                                        id="scheduler"
                                        class="h-8 w-8"
                                        viewBox="0 0 24 24"
                                        fill="currentColor"
                                        transform="translate(85.333333, 85.333333)"
                                    >
                                        <path
                                            d="M170.666667,1.42108547e-14 C264.923264,-3.10380131e-15 341.333333,76.4100694 341.333333,170.666667 C341.333333,264.923264 264.923264,341.333333 170.666667,341.333333 C76.4100694,341.333333 2.57539587e-14,264.923264 1.42108547e-14,170.666667 C2.6677507e-15,76.4100694 76.4100694,3.15255107e-14 170.666667,1.42108547e-14 Z M170.666667,42.6666667 C99.9742187,42.6666667 42.6666667,99.9742187 42.6666667,170.666667 C42.6666667,241.359115 99.9742187,298.666667 170.666667,298.666667 C241.359115,298.666667 298.666667,241.359115 298.666667,170.666667 C298.666667,99.9742187 241.359115,42.6666667 170.666667,42.6666667 Z M192,85.3333333 L191.999333,149.333333 L256,149.333333 L256,192 L191.999333,191.999333 L192,256 L149.333333,256 L149.333333,191.999333 L85.3333333,192 L85.3333333,149.333333 L149.333333,149.333333 L149.333333,85.3333333 L192,85.3333333 Z"
                                            id="Combined-Shape"
                                        ></path>
                                    </g>
                                </g>
                            </g>
                        </svg>

                        <!--<svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-8 w-8"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                        >
                            <path
                                d="M10 20H14V16H10V20ZM3 14H21V10H3V14ZM10 4V8H14V4H10Z"
                            ></path>
                        </svg>-->
                    </div>
                    <h3 class="text-xl font-semibold text-gray-50 mb-3">
                        Create a Test Suite
                    </h3>
                    <p class="text-gray-400">
                        Click the "Create Test Suite" button above to create a
                        suite, or visit the GitHub repo for REST calls.
                        <br /><br />
                        <b>Important:</b> Save your test id! It will never be
                        shown again, ever.
                    </p>
                </div>

                <!-- Card 2 -->
                <div
                    class="p-6 bg-dark-card rounded-xl border border-gray-800 hover:border-primary-accent/50 transition duration-300 shadow-lg"
                >
                    <div class="text-purple-400 mb-3 text-2xl font-bold">
                        <!-- Icon for Reporting -->
                        <!--<svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-8 w-8"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                        >
                            <path
                                d="M21 15.01L17 15V3H7V15H3L3.01 15.01L12 21L21 15.01ZM12 4H19V14H5V4H12Z"
                            ></path>
                        </svg>-->
                        <svg
                            viewBox="0 0 24 24"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-8 w-8"
                            viewBox="0 0 24 24"
                        >
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g
                                id="SVGRepo_tracerCarrier"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            ></g>
                            <g id="SVGRepo_iconCarrier">
                                <path
                                    d="M14 10C14 9.44771 13.5523 9 13 9H12.5C9.46243 9 7 11.4624 7 14.5C7 17.5376 9.46243 20 12.5 20H17.5C20.5376 20 23 17.5376 23 14.5C23 12.0091 21.3441 9.90488 19.073 9.22823C18.5098 9.06042 18 9.52887 18 10.1166V10.1683C18 10.6659 18.3745 11.0735 18.8345 11.2634C20.1055 11.788 21 13.0395 21 14.5C21 16.433 19.433 18 17.5 18H12.5C10.567 18 9 16.433 9 14.5C9 12.567 10.567 11 12.5 11H13C13.5523 11 14 10.5523 14 10Z"
                                    fill="currentColor"
                                ></path>
                                <path
                                    d="M11.5 4C14.5376 4 17 6.46243 17 9.5C17 12.5376 14.5376 15 11.5 15H11C10.4477 15 10 14.5523 10 14C10 13.4477 10.4477 13 11 13H11.5C13.433 13 15 11.433 15 9.5C15 7.567 13.433 6 11.5 6H6.5C4.567 6 3 7.567 3 9.5C3 10.9605 3.89451 12.212 5.16553 12.7366C5.62548 12.9264 6 13.3341 6 13.8317V13.8834C6 14.4711 5.49024 14.9396 4.92699 14.7718C2.65592 14.0951 1 11.9909 1 9.5C1 6.46243 3.46243 4 6.5 4H11.5Z"
                                    fill="currentColor"
                                ></path>
                            </g>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-50 mb-3">
                        Add test cases
                    </h3>
                    <p class="text-gray-400">
                        Test cases are added in the test dashboard. HTTP
                        services can be tested immediately, others can update
                        results using a simple REST call.
                        <br /><br />
                    </p>
                </div>

                <!-- Card 3 -->
                <div
                    class="p-6 bg-dark-card rounded-xl border border-gray-800 hover:border-primary-accent/50 transition duration-300 shadow-lg"
                >
                    <div class="text-pink-400 mb-3 text-2xl font-bold">
                        <!-- Icon for Resilience -->
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-8 w-8"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                        >
                            <path
                                d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20ZM12 6.5C8.96 6.5 6.5 8.96 6.5 12C6.5 15.04 8.96 17.5 12 17.5C15.04 17.5 17.5 15.04 17.5 12C17.5 8.96 15.04 6.5 12 6.5ZM12 15.5C10.07 15.5 8.5 13.93 8.5 12C8.5 10.07 10.07 8.5 12 8.5C13.93 8.5 15.5 10.07 15.5 12C15.5 13.93 13.93 15.5 12 15.5Z"
                            ></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-50 mb-3">
                        View results in real-time
                    </h3>
                    <p class="text-gray-400">
                        Results are displayed in real-time in your dashboard,
                        and can be retrieved in
                        <a href="https://ctrf.io/docs/specification/examples"
                            >CTRF</a
                        >
                        format in YAML or JSON via REST. Monitor your tests in
                        real-time at
                        <b
                            ><a href="https://tdd.upstr.dev/dash"
                                >https://tdd.upstr.dev/dash</a
                            ></b
                        >.
                    </p>
                </div>
            </section>

            <!-- Usage Section -->
            <section id="usage" class="space-y-12">
                <h2 class="text-4xl font-bold text-gray-200 text-center">
                    Usage
                </h2>

                <!-- Step 1 -->
                <div
                    class="flex flex-col lg:flex-row bg-dark-card p-6 rounded-xl border border-gray-800 shadow-xl"
                >
                    <div class="lg:pr-8 mb-4 lg:mb-0">
                        <h3
                            class="text-2xl font-semibold text-primary-accent mb-2"
                        >
                            Simple and Scalable Deployment
                        </h3>
                        <div class="flex">
                            <!--<svg
                                width="320px"
                                viewBox="0 0 16 16"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                <g
                                    id="SVGRepo_tracerCarrier"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                ></g>
                                <g id="SVGRepo_iconCarrier">
                                    <path
                                        fill-rule="evenodd"
                                        clip-rule="evenodd"
                                        d="M12 0H4V2H1V5L4 8H1V11L4 14V16H12V14L15 11V8H12L15 5V2H12V0ZM8 5C8.82843 5 9.5 4.32843 9.5 3.5C9.5 2.67157 8.82843 2 8 2C7.17157 2 6.5 2.67157 6.5 3.5C6.5 4.32843 7.17157 5 8 5ZM8 14C8.82843 14 9.5 13.3284 9.5 12.5C9.5 11.6716 8.82843 11 8 11C7.17157 11 6.5 11.6716 6.5 12.5C6.5 13.3284 7.17157 14 8 14ZM9.5 8C9.5 8.82843 8.82843 9.5 8 9.5C7.17157 9.5 6.5 8.82843 6.5 8C6.5 7.17157 7.17157 6.5 8 6.5C8.82843 6.5 9.5 7.17157 9.5 8Z"
                                        fill="#0d9488"
                                    ></path>
                                </g>
                            </svg>-->
                            <p class="text-gray-400">
                                The API Tester service is a single container
                                using a storage directory for tests and results.
                                Use the SaaS version (unsupported) for free, or
                                deploy to
                                <a href="https://cloud.google.com/run"
                                    >Google Cloud Run</a
                                >, or other container platforms, with
                                scale-to-zero during non-use for free/cheap
                                self-deployments.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Step 2 -->
                <div
                    class="flex flex-col lg:flex-row bg-dark-card p-6 rounded-xl border border-gray-800 shadow-xl"
                >
                    <div class="lg:pr-8 mb-4 lg:mb-0">
                        <h3
                            class="text-2xl font-semibold text-primary-accent mb-2"
                        >
                            Edit test cases in the browser or update via REST
                            API
                        </h3>
                        <p class="text-gray-400">
                            Test cases can be continually updated in the
                            dashboard editor, or pushed via REST calls. Test
                            results can be run for HTTP services by clicking the
                            "Save & Run" button in the dashboard, or calling the
                            <b>/run</b> REST endpoint. Results for other
                            platforms can be ingested via REST calls to the
                            <b>/results</b> endpoint.
                        </p>
                    </div>
                </div>
                <!-- Step 3 -->
                <div
                    class="flex flex-col lg:flex-row bg-dark-card p-6 rounded-xl border border-gray-800 shadow-xl"
                >
                    <div class="lg:pr-8 mb-4 lg:mb-0">
                        <h3
                            class="text-2xl font-semibold text-primary-accent mb-2"
                        >
                            View live results in the dashboard
                        </h3>
                        <p class="text-gray-400">
                            The service pushes out live result updates to the
                            dashboard via <b>SSE events</b>. Watch as your test
                            results improve, monitor the traffic light status of
                            all tests in true <b>TDD glory</b>. Quick, easy &
                            pragmatic - how software should be!
                        </p>
                    </div>
                </div>
            </section>

            <!-- Integration Section -->
            <section id="integration" class="space-y-8">
                <h2 class="text-4xl font-bold text-gray-200 text-center">
                    Seamless Integration
                </h2>
                <p class="text-lg text-gray-400 text-center max-w-2xl mx-auto">
                    API Tester works out-of-the-box for public HTTP services, as
                    well as in Apigee proxies via policies. Ingesting results
                    from any platform is easy, so more integrations can be
                    easily added!
                </p>

                <div class="grid md:grid-cols-2 gap-8 pt-6">
                    <!-- CI/CD Card -->
                    <div
                        class="bg-dark-card p-6 rounded-xl border-t-4 border-l-4 border-purple-500 shadow-xl"
                    >
                        <h3 class="text-2xl font-semibold text-purple-400 mb-4">
                            Public HTTP Services
                        </h3>
                        <p class="text-gray-400 mb-4">
                            Public HTTP Services can be tested automatically by
                            API Tester via fetch calls. Test cases are executed
                            in-process, and saved as results as well as
                            broadcast out in real-time to any dashboards that
                            are listening.
                        </p>
                        <pre
                            class="bg-gray-900 p-4 rounded-lg text-sm overflow-x-auto border border-gray-700 shadow-inner"
                        >
                        <code class="text-white block">
name: Mock Target Tests v1
tests:
- name: test response payload
  url: https://mocktarget.apigee.net
  path: /json
  verb: GET
  assertions:
    - $.firstName==john
    - $.city==San Jose
    - response.header.content-length==68
                        </code>
                    </pre>
                    </div>

                    <!-- Framework Card -->
                    <div
                        class="bg-dark-card p-6 rounded-xl border-t-4 border-l-4 border-teal-500 shadow-xl"
                    >
                        <h3 class="text-2xl font-semibold text-teal-400 mb-4">
                            Apigee Proxies
                        </h3>
                        <p class="text-gray-400 mb-4">
                            Add the policies to your proxy, pass in an
                            <b>x-upstream-id</b> header, and watch as your
                            internal proxy tests of runtime variables are run
                            and updated in real-time.
                        </p>
                        <pre
                            class="bg-gray-900 p-4 rounded-lg text-sm overflow-x-auto border border-gray-700 shadow-inner"
                        >
                            <code class="text-white block">
name: Gemini proxy test
tests:
  - name: test prompt variables
    url: https://api.mycompany.com
    path: /gemini
    verb: POST
    assertions:
      - llm.promptInput==why is the sky blue?
      - llm.extimatedTokenLength==4
EOF
                            </code>
                    </pre>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-900 mt-20">
            <div
                class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 text-center text-gray-400"
            >
                <p>Free and Open Source Software, Enjoy!</p>
            </div>
        </footer>

        <!-- Modal/Popup for Test Suite Creation -->
        <div
            id="suiteModal"
            class="fixed inset-0 bg-black bg-opacity-80 hidden z-50 transition-opacity duration-300"
            aria-modal="true"
        >
            <div class="flex items-center justify-center min-h-screen p-4">
                <div
                    class="bg-gray-800 rounded-xl shadow-2xl p-8 w-full max-w-4xl transform transition-all duration-300 scale-100 border-t-4 border-primary-accent/50"
                >
                    <h3
                        class="text-3xl font-bold text-gray-50 mb-4 flex items-center"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-8 w-8 text-primary-accent mr-3"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                        >
                            <path
                                d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20ZM11 15H13V17H11V15ZM11 7H13V13H11V7Z"
                            ></path>
                        </svg>
                        Test Suite Created Successfully
                    </h3>
                    <p class="text-gray-300 mb-6">
                        <b>Save these Ids!</b> Your Admin Test Id can be used to
                        start & update tests, while the first 4 sections can be
                        used to view results. They will not be shown again,
                        ever.
                    </p>

                    <!-- UUID Display -->
                    <div class="mb-4">
                        <label
                            class="block text-sm font-medium text-gray-400 mb-1"
                            >Admin Test Suite Id</label
                        >
                        <div
                            class="flex items-center bg-gray-900 rounded-lg border border-gray-700 p-3"
                        >
                            <span
                                id="suiteUuidDisplay"
                                class="flex-grow font-mono text-lg text-primary-accent select-all overflow-x-auto whitespace-nowrap"
                            ></span>
                            <button
                                id="copyUuidBtn"
                                class="ml-3 p-2 rounded-full text-gray-400 hover:text-white hover:bg-gray-700 transition duration-150"
                            >
                                <!-- Copy Icon -->
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="h-5 w-5"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                >
                                    <path
                                        d="M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z"
                                    ></path>
                                </svg>
                            </button>
                        </div>
                        <p
                            id="uuidCopyMessage"
                            class="text-xs text-green-400 mt-1 hidden"
                        >
                            Copied!
                        </p>
                    </div>

                    <!-- Link Display -->
                    <div class="mb-6">
                        <label
                            class="block text-sm font-medium text-gray-400 mb-1"
                            >Admin Link</label
                        >
                        <div
                            class="flex items-center bg-gray-900 rounded-lg border border-gray-700 p-3"
                        >
                            <a
                                id="suiteLinkDisplay"
                                href="#"
                                target="_blank"
                                class="flex-grow font-mono text-lg text-purple-400 hover:underline overflow-x-auto whitespace-nowrap"
                            ></a>
                            <button
                                id="copyLinkBtn"
                                class="ml-3 p-2 rounded-full text-gray-400 hover:text-white hover:bg-gray-700 transition duration-150"
                            >
                                <!-- Link Icon -->
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="h-5 w-5"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                >
                                    <path
                                        d="M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z"
                                    ></path>
                                </svg>
                            </button>
                        </div>
                        <p
                            id="linkCopyMessage"
                            class="text-xs text-green-400 mt-1 hidden"
                        >
                            Copied!
                        </p>
                    </div>

                    <!-- Public Id Display -->
                    <!--<div class="mb-4">
                        <label
                            class="block text-sm font-medium text-gray-400 mb-1"
                            >Public Read-Only Id</label
                        >
                        <div
                            class="flex items-center bg-gray-900 rounded-lg border border-gray-700 p-3"
                        >
                            <span
                                id="publicIdDisplay"
                                class="flex-grow font-mono text-lg text-primary-accent select-all overflow-x-auto whitespace-nowrap"
                            ></span>
                            <button
                                id="copyPublicIdBtn"
                                class="ml-3 p-2 rounded-full text-gray-400 hover:text-white hover:bg-gray-700 transition duration-150"
                            >

                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="h-5 w-5"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                >
                                    <path
                                        d="M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z"
                                    ></path>
                                </svg>
                            </button>
                        </div>
                        <p
                            id="publicIdCopyMessage"
                            class="text-xs text-green-400 mt-1 hidden"
                        >
                            Copied!
                        </p>
                    </div>

                    <div class="mb-6">
                        <label
                            class="block text-sm font-medium text-gray-400 mb-1"
                            >Public Read-Only Link</label
                        >
                        <div
                            class="flex items-center bg-gray-900 rounded-lg border border-gray-700 p-3"
                        >
                            <a
                                id="publicLinkDisplay"
                                href="#"
                                target="_blank"
                                class="flex-grow font-mono text-lg text-purple-400 hover:underline overflow-x-auto whitespace-nowrap"
                            ></a>
                            <button
                                id="copyPublicLinkBtn"
                                class="ml-3 p-2 rounded-full text-gray-400 hover:text-white hover:bg-gray-700 transition duration-150"
                            >

                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="h-5 w-5"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                >
                                    <path
                                        d="M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z"
                                    ></path>
                                </svg>
                            </button>
                        </div>
                        <p
                            id="publicLinkCopyMessage"
                            class="text-xs text-green-400 mt-1 hidden"
                        >
                            Copied!
                        </p>
                    </div>-->

                    <button
                        id="closeModalBtn"
                        class="w-full mt-4 py-3 bg-gray-700 text-gray-100 rounded-xl hover:bg-gray-600 transition duration-300"
                    >
                        Close
                    </button>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const openModalBtn = document.getElementById("openModalBtn");
                const closeModalBtn = document.getElementById("closeModalBtn");
                const suiteModal = document.getElementById("suiteModal");
                const suiteUuidDisplay =
                    document.getElementById("suiteUuidDisplay");
                const publicIdDisplay =
                    document.getElementById("publicIdDisplay");
                const suiteLinkDisplay =
                    document.getElementById("suiteLinkDisplay");
                const publicLinkDisplay =
                    document.getElementById("publicLinkDisplay");
                const copyUuidBtn = document.getElementById("copyUuidBtn");
                const copyPublicIdBtn =
                    document.getElementById("copyPublicIdBtn");
                const copyPublicLinkBtn =
                    document.getElementById("copyPublicLinkBtn");
                const uuidCopyMessage =
                    document.getElementById("uuidCopyMessage");
                const publicIdCopyMessage = document.getElementById(
                    "publicIdCopyMessage",
                );
                const linkCopyMessage =
                    document.getElementById("linkCopyMessage");
                const publicLinkCopyMessage = document.getElementById(
                    "publicLinkCopyMessage",
                );
                /**
                 * Generates a UUID V4 (or uses crypto.randomUUID if available)
                 * @returns {string} The generated UUID.
                 */
                async function createTestSuite() {
                    let responseJson = undefined;
                    let response = await fetch("/tests", {
                        method: "POST",
                    });
                    if (response.status == 201) {
                        responseJson = await response.json();
                    }

                    return responseJson;
                }

                /**
                 * Copies text to the clipboard using document.execCommand (reliable in iframes).
                 * @param {string} text The text to copy.
                 * @param {HTMLElement} messageElement The success message element to show.
                 */
                function copyToClipboard(text, messageElement) {
                    const tempInput = document.createElement("textarea");
                    tempInput.value = text;
                    tempInput.style.position = "absolute";
                    tempInput.style.left = "-9999px";
                    document.body.appendChild(tempInput);
                    tempInput.select();
                    try {
                        document.execCommand("copy");
                        messageElement.classList.remove("hidden");
                        setTimeout(() => {
                            messageElement.classList.add("hidden");
                        }, 1500);
                    } catch (err) {
                        console.error("Could not copy text: ", err);
                    }
                    document.body.removeChild(tempInput);
                }

                // --- Event Listeners ---

                openModalBtn.addEventListener("click", async () => {
                    const testSuite = await createTestSuite();
                    if (testSuite) {
                        const adminLink = `${window.location.origin}/dash?id=${testSuite.id}`;
                        const publicLink = `${window.location.origin}/dash?id=${testSuite.viewId}`;

                        suiteUuidDisplay.textContent = testSuite.id;
                        if (publicIdDisplay)
                            publicIdDisplay.textContent = testSuite.viewId;
                        suiteLinkDisplay.textContent = adminLink;
                        suiteLinkDisplay.href = adminLink;
                        if (publicLinkDisplay)
                            publicLinkDisplay.textContent = publicLink;
                        if (publicLinkDisplay)
                            publicLinkDisplay.href = publicLink;
                        // Reset copy messages
                        uuidCopyMessage.classList.add("hidden");
                        if (publicIdCopyMessage)
                            publicIdCopyMessage.classList.add("hidden");
                        linkCopyMessage.classList.add("hidden");
                        if (publicLinkCopyMessage)
                            publicLinkCopyMessage.classList.add("hidden");

                        suiteModal.classList.remove("hidden");
                    } else {
                        alert(
                            "Test Suite could not be created, please check with the service owner on possible reasons.",
                        );
                    }
                });

                closeModalBtn.addEventListener("click", () => {
                    suiteModal.classList.add("hidden");
                });

                // Close modal on outside click
                suiteModal.addEventListener("click", (e) => {
                    if (e.target === suiteModal) {
                        suiteModal.classList.add("hidden");
                    }
                });

                // Close modal on ESC key
                document.addEventListener("keydown", (e) => {
                    if (
                        e.key === "Escape" &&
                        !suiteModal.classList.contains("hidden")
                    ) {
                        suiteModal.classList.add("hidden");
                    }
                });

                // Copy UUID button handler
                copyUuidBtn.addEventListener("click", () => {
                    const uuidText = suiteUuidDisplay.textContent;
                    copyToClipboard(uuidText, uuidCopyMessage);
                });
                if (copyPublicIdBtn)
                    copyPublicIdBtn.addEventListener("click", () => {
                        const uuidText = publicIdDisplay.textContent;
                        copyToClipboard(uuidText, publicIdCopyMessage);
                    });

                // Copy Link button handler
                copyLinkBtn.addEventListener("click", () => {
                    const linkText = suiteLinkDisplay.textContent;
                    copyToClipboard(linkText, linkCopyMessage);
                });
                if (copyPublicLinkBtn)
                    copyPublicLinkBtn.addEventListener("click", () => {
                        const linkText = publicLinkDisplay.textContent;
                        copyToClipboard(linkText, publicLinkCopyMessage);
                    });
            });

            function openDashboard() {
                window.location.href = "/dash";
            }
        </script>
    </body>
</html>
